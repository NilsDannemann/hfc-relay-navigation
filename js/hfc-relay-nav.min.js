"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),HFCRelayNav=function(){function HFCRelayNav(){_classCallCheck(this,HFCRelayNav),this.options={initCallback:function(){},vpHeight:!1,vpWidth:!1,backLinkText:"ZurÃ¼ck"}}return _createClass(HFCRelayNav,[{key:"init",value:function(e,t){var n=this,o=document.querySelector(e);n._setViewport(),n.options=Object.assign(n.options,t),window.addEventListener("resize",function(){n._setViewport()},!0),this._applySubmenuToElement(o,"has-submenu");var a=o.querySelectorAll(".has-submenu");n._map(a,function(e){e.querySelector("a:not(.back)").addEventListener("click",function(t){var o=t.target.parentNode,a=["show"],s=parseInt(e.getElementsByTagName("ul")[0].getBoundingClientRect().right);o.classList.contains("has-submenu")&&t.preventDefault(),s>=n.options.vpWidth&&a.push("from-left"),n._toggleClass(o,"is-open"),n._toggleClass(o.querySelector("ul"),a)})}),document.addEventListener("click",function(e){var t=o.querySelectorAll("ul.show");if(n._getClosest(e.target,".has-submenu")||n._getClosest(e.target,".priority-nav-is-visible")||e.target===e.target.querySelector(".has-submenu")||e.target.classList.contains("back"))if(n._getClosest(e.target,".priority-nav-is-visible")){var a=o.querySelectorAll("li.is-open");n._map(a,function(e){n._toggleClass(e.querySelector("ul.show"),"show"),n._toggleClass(e,"is-open")})}else e.target.classList.contains("back")||n._map(t,function(t){var o=n._getClosest(e.target.parentNode,".is-open");t.parentNode===o||t.parentNode.contains(o)||(n._toggleClass(t,"show"),n._toggleClass(t.parentNode,"is-open"))});else n._map(t,function(e){n._toggleClass(e,"show"),n._toggleClass(e.parentNode,"is-open")})});var s=o.querySelectorAll("a.back");n._map(s,function(e){e.addEventListener("click",function(){var t=e.parentNode.parentNode;t.classList.contains("show")&&(n._toggleClass(t,"show"),t.parentNode.classList.contains("has-submenu")&&n._toggleClass(t.parentNode,"is-open"))})}),n.options.initCallback()}},{key:"_toggleClass",value:function(e,t){var n=this,o=e&&e.className?e.className.split(" "):[],a=o.indexOf("show")!==-1?"hide":"show",s="undefined"==typeof t?"undefined":_typeof(t);if("string"===s)e.classList.toggle(t);else if("object"===s){var l=o.indexOf("from-left");t.map(function(t){e.classList.toggle(t)}),1===l&&setTimeout(function(){e.classList.toggle("from-left")},350),"hide"==a&&n._map(e.querySelectorAll("ul.show"),function(e){n._toggleClass(e,"show")})}}},{key:"_setViewport",value:function _setViewport(){var root=this;["Width","Height"].map(function(name){var docVal=document.documentElement["client"+name],winVal=window["inner"+name],number=Math.min(docVal,winVal);eval("root.options.vp"+name+" = "+number)})}},{key:"_getClosest",value:function(e,t){for(var n=t.charAt(0);e&&e!==document;e=e.parentNode)if("."===n){if(e.classList.contains(t.substr(1)))return e}else if("#"===n){if(e.id===t.substr(1))return e}else if("["===n&&e.hasAttribute(t.substr(1,t.length-2)))return e;return!1}},{key:"_applySubmenuToElement",value:function(e,t){var n=this;n._map(e.querySelectorAll("li"),function(e){if(e.childNodes.length>1){var o=document.createElement("li"),a=document.createElement("a");a.appendChild(document.createTextNode(n.options.backLinkText)),a.classList="back",o.appendChild(a);var s=e.querySelector("ul");s.insertBefore(o,s.firstChild),n._toggleClass(e,t)}})}},{key:"_map",value:function(e,t){return Array.prototype.map.call(e,t)}}]),HFCRelayNav}();