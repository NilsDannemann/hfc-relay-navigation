"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":_typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":_typeof2(e)},_createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),HFCRelayNav=function(){function HFCRelayNav(){_classCallCheck(this,HFCRelayNav),this.options={initCallback:function(){},vpHeight:!1,vpWidth:!1,backLinkText:"ZurÃ¼ck",pusher:!0}}return _createClass(HFCRelayNav,[{key:"init",value:function(e,t){var o=this,n=document.querySelector(e);o._setViewport(),o.options=Object.assign(o.options,t),window.addEventListener("resize",function(){o._setViewport()},!0),o.options.pusher&&o._toggleClass(document.querySelector("body"),"pusher"),this._applySubmenuToElement(n,"has-submenu");var s=n.querySelectorAll(".has-submenu");o._map(s,function(e){e.querySelector("a:not(.back)").addEventListener("click",function(t){var n=t.target.parentNode,s=["show"],a=parseInt(e.getElementsByTagName("ul")[0].getBoundingClientRect().right);n.classList.contains("has-submenu")&&t.preventDefault(),a>=o.options.vpWidth&&s.push("from-left"),o._toggleClass(n,"is-open"),o._toggleClass(n.querySelector("ul"),s)})}),document.addEventListener("click",function(e){var t=n.querySelectorAll("ul.show");if(o._getClosest(e.target,".has-submenu")||o._getClosest(e.target,".priority-nav-is-visible")||e.target===e.target.querySelector(".has-submenu")||e.target.classList.contains("back"))if(o._getClosest(e.target,".priority-nav-is-visible")){var s=n.querySelectorAll("li.is-open");o._map(s,function(e){o._toggleClass(e.querySelector("ul.show"),"show"),o._toggleClass(e,"is-open")}),o.options.pusher&&o._toggleClass(document.querySelector("body"),"is-open")}else e.target.classList.contains("back")||o._map(t,function(t){var n=o._getClosest(e.target.parentNode,".is-open");t.parentNode===n||t.parentNode.contains(n)||(o._toggleClass(t,"show"),o._toggleClass(t.parentNode,"is-open"))});else{o._map(t,function(e){o._toggleClass(e,"show"),o._toggleClass(e.parentNode,"is-open")});var a=document.querySelector("body");o.options.pusher&&a.classList.contains("is-open")&&o._toggleClass(a,"is-open")}});var a=n.querySelectorAll("a.back");o._map(a,function(e){e.addEventListener("click",function(){var t=e.parentNode.parentNode;t.classList.contains("show")&&(o._toggleClass(t,"show"),t.parentNode.classList.contains("has-submenu")&&o._toggleClass(t.parentNode,"is-open"))})}),o.options.initCallback()}},{key:"_toggleClass",value:function(e,t){var o=this,n=e&&e.className?e.className.split(" "):[],s=n.indexOf("show")!==-1?"hide":"show",a=n.indexOf("from-left"),l="undefined"==typeof t?"undefined":_typeof(t);"string"===l?e.classList.toggle(t):"object"===l&&(t.map(function(t){e.classList.toggle(t)}),"hide"==s&&o._map(e.querySelectorAll("ul.show"),function(e){o._toggleClass(e,"show")})),1===a&&setTimeout(function(){e.classList.toggle("from-left")},350)}},{key:"_setViewport",value:function _setViewport(){var root=this;["Width","Height"].map(function(name){var docVal=document.documentElement["client"+name],winVal=window["inner"+name],number=Math.min(docVal,winVal);eval("root.options.vp"+name+" = "+number)})}},{key:"_getClosest",value:function(e,t){for(var o=t.charAt(0);e&&e!==document;e=e.parentNode)if("."===o){if(e.classList.contains(t.substr(1)))return e}else if("#"===o){if(e.id===t.substr(1))return e}else if("["===o&&e.hasAttribute(t.substr(1,t.length-2)))return e;return!1}},{key:"_applySubmenuToElement",value:function(e,t){var o=this;o._map(e.querySelectorAll("li"),function(e){if(e.childNodes.length>1){var n=document.createElement("li"),s=document.createElement("a");s.appendChild(document.createTextNode(o.options.backLinkText)),s.classList="back",n.appendChild(s);var a=e.querySelector("ul");a.insertBefore(n,a.firstChild),o._toggleClass(e,t)}})}},{key:"_map",value:function(e,t){return Array.prototype.map.call(e,t)}}]),HFCRelayNav}();